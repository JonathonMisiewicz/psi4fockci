import sys, os
import glob
sys.path.append('/Users/shannonhouck/psi4_spinflip_wfn')
import spinflip
import numpy as np
from spinflip import sf_cas
import psi4

# setting up molecule
n2 = psi4.core.Molecule.create_molecule_from_string("""
0 3
O 0 0 0
O 0 0 2.0
symmetry c1
""")
# set target charge and multiplicity
charge = 0
multiplicity = 1

# running the spin-flip calculation
opts = {'basis': 'sto-3g', 'NUM_ROOTS': 3, 'reference': 'rohf', 'guess': 'gwh'}
psi4.set_options(opts)

ref_e, ref_wfn = psi4.energy('scf', molecule=n2, return_wfn=True)

e, ci_wfn, scf_wfn = sf_cas( charge, multiplicity, n2, conf_space="1x", add_opts=opts, return_rohf_wfn=True, return_ci_wfn=True, write_ci_vects=True, read_rohf_wfn=True, wfn_rohf_in=ref_wfn)


