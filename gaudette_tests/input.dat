import sys, os
sys.path.insert(1, '/usr/local/psi4/lib')
import psi4
sys.path.insert(1, '../')

import spinflip
from spinflip import sf_cas

mol_002 = psi4.core.Molecule.create_molecule_from_string("""
2 9
 Fe           1.259590471125    -3.451222689970    -1.726655744681
 Fe          -1.259589528875     3.451227310030     1.726654255319
 Br          -1.766689528875     1.194027310030    -2.561265744681
 Br           1.766690471125    -1.194032689970     2.561274255319
 C           -0.551799528875    -1.438252689970    -3.492645744681
 C           -1.853779528875    -1.932232689970    -3.697165744681
 C           -0.747529528875     0.453847310030    -1.119635744681
 C           -2.360749528875    -1.876892689970    -4.992485744681
 H           -3.233909528875    -2.213842689970    -5.157675744681
 C           -0.390199528875    -0.870492689970    -5.818445744681
 C           -1.652219528875    -1.360582689970    -6.028215744681
 H           -2.031739528875    -1.339632689970    -6.898755744681
 C           -2.690689528875    -2.359892689970    -2.543435744681
 H           -2.139819528875    -2.863302689970    -1.906265744681
 H           -3.421849528875    -2.928592689970    -2.860715744681
 H           -3.062829528875    -1.569642689970    -2.097685744681
 C            0.721520471125     3.841127310030    -1.232385744681
 H           -0.255349528875     3.826407310030    -1.300565744681
 C           -3.097219528875     4.526657310030    -1.242875744681
 H           -2.505739528875     4.400217310030    -2.013775744681
 H           -3.999099528875     4.748717310030    -1.554905744681
 H           -3.127889528875     3.700867310030    -0.715835744681
 C           -2.575179528875     5.642997310030    -0.388075744681
 C           -2.473299528875     6.950627310030    -0.891515744681
 H           -2.712739528875     7.129727310030    -1.793515744681
 C           -2.033419528875     7.967237310030    -0.089155744681
 H           -1.893109528875     8.838797310030    -0.440515744681
 H           -1.041549528875    -4.512052689970    -3.830895744681
 C           -1.955559528875    -6.486462689970    -1.798765744681
 H           -2.247439528875    -7.050082689970    -2.506725744681
 C           -2.443179528875    -6.639392689970    -0.542775744681
 H           -3.057309528875    -7.338512689970    -0.348735744681
 O           -1.479069528875     2.261147310030     0.164664255319
 N            0.600250471125     4.658277310030     1.069814255319
 N           -0.926099528875     4.859417310030     3.395624255319
 N           -2.249819528875     5.365477310030     0.888894255319
 N           -2.919739528875     3.039587310030     3.183234255319
 C           -0.779529528875     1.189397310030     0.031464255319
 C            1.024600471125     5.492527310030     2.029504255319
 C            0.514620471125     5.240127310030     3.413974255319
 H            0.631380471125     6.055417310030     3.961994255319
 C           -1.903849528875     6.425747310030     1.696504255319
 C           -1.761069528875     6.063247310030     3.151764255319
 H           -1.361419528875     6.830167310030     3.634234255319
 H           -2.661519528875     5.907427310030     3.531974255319
 C           -1.795039528875     7.694497310030     1.253364255319
 H           -1.558809528875     8.393487310030     1.851204255319
 C           -4.034309528875     2.374917310030     2.957734255319
 C           -2.636289528875     3.485097310030     4.436594255319
 C           -1.346659528875     4.210777310030     4.628014255319
 H           -1.454699528875     4.893327310030     5.338604255319
 H           -0.647979528875     3.574287310030     4.919064255319
 C           -4.962789528875     2.106807310030     4.032794255319
 H           -5.770219528875     1.629357310030     3.883334255319
 C           -4.635859528875     2.563877310030     5.259934255319
 H           -5.243509528875     2.418147310030     5.975774255319
 C           -4.290449528875     1.872627310030     1.599484255319
 H           -4.314159528875     2.625857310030     0.972804255319
 H           -5.151529528875     1.404727310030     1.581124255319
 H           -3.577469528875     1.253117310030     1.339894255319
 C           -3.465189528875     3.228937310030     5.516904255319
 H           -3.231489528875     3.503377310030     6.397924255319
 N           -0.067709528875     1.610797310030     2.220924255319
 C            0.024020471125     0.764367310030     1.237634255319
 C           -1.129469528875    -4.803402689970     0.175684255319
 C           -0.177579528875     0.874407310030     4.530994255319
 H           -0.107549528875     0.524847310030     6.552634255319
 H           -1.045979528875    -2.946302689970     0.999024255319
 H           -1.105719528875    -4.115892689970     2.089814255319
 C           -1.472189528875     0.173717310030     4.276644255319
 H           -1.295939528875    -0.745382689970     3.988214255319
 H           -2.002999528875     0.160137310030     5.102614255319
 H           -1.967959528875     0.648597310030     3.576544255319
 C           -2.045379528875    -5.787112689970     0.432644255319
 H           -2.408459528875    -5.873422689970     1.305804255319
 N            0.067710471125    -1.610802689970    -2.220925744681
 C           -0.024019528875    -0.764362689970    -1.237635744681
 C            1.129470471125     4.803407310030    -0.175685744681
 C            0.177580471125    -0.874402689970    -4.530995744681
 H            0.107550471125    -0.524842689970    -6.552635744681
 H            1.045980471125     2.946307310030    -0.999025744681
 H            1.105720471125     4.115897310030    -2.089815744681
 C            1.472190471125    -0.173712689970    -4.276645744681
 H            1.295940471125     0.745387310030    -3.988215744681
 H            2.003000471125    -0.160132689970    -5.102615744681
 H            1.967960471125    -0.648592689970    -3.576545744681
 C            2.045380471125     5.787107310030    -0.432645744681
 H            2.408460471125     5.873427310030    -1.305805744681
 O            1.479070471125    -2.261152689970    -0.164665744681
 N           -0.600249528875    -4.658272689970    -1.069815744681
 N            0.926100471125    -4.859412689970    -3.395625744681
 N            2.249820471125    -5.365482689970    -0.888895744681
 N            2.919740471125    -3.039592689970    -3.183235744681
 C            0.779530471125    -1.189402689970    -0.031465744681
 C           -1.024599528875    -5.492532689970    -2.029505744681
 C           -0.514619528875    -5.240122689970    -3.413975744681
 H           -0.631379528875    -6.055422689970    -3.961995744681
 C            1.903850471125    -6.425752689970    -1.696495744681
 C            1.761070471125    -6.063242689970    -3.151765744681
 H            1.361420471125    -6.830172689970    -3.634235744681
 H            2.661520471125    -5.907422689970    -3.531975744681
 C            1.795040471125    -7.694492689970    -1.253365744681
 H            1.558810471125    -8.393492689970    -1.851205744681
 C            4.034310471125    -2.374922689970    -2.957735744681
 C            2.636290471125    -3.485092689970    -4.436595744681
 C            1.346660471125    -4.210772689970    -4.628005744681
 H            1.454700471125    -4.893322689970    -5.338605744681
 H            0.647980471125    -3.574282689970    -4.919065744681
 C            4.962790471125    -2.106802689970    -4.032795744681
 H            5.770220471125    -1.629352689970    -3.883335744681
 C            4.635860471125    -2.563872689970    -5.259935744681
 H            5.243510471125    -2.418152689970    -5.975775744681
 C            4.290440471125    -1.872632689970    -1.599485744681
 H            4.314160471125    -2.625852689970    -0.972795744681
 H            5.151530471125    -1.404722689970    -1.581125744681
 H            3.577470471125    -1.253122689970    -1.339895744681
 C            3.465190471125    -3.228932689970    -5.516905744681
 H            3.231490471125    -3.503382689970    -6.397925744681
 H            1.041550471125     4.512047310030     3.830894255319
 C            1.955560471125     6.486467310030     1.798764255319
 H            2.247440471125     7.050077310030     2.506734255319
 C            2.443180471125     6.639387310030     0.542774255319
 H            3.057310471125     7.338507310030     0.348734255319
 C            0.551800471125     1.438247310030     3.492644255319
 C            1.853780471125     1.932237310030     3.697164255319
 C            0.747530471125    -0.453842689970     1.119634255319
 C            2.360750471125     1.876897310030     4.992484255319
 H            3.233910471125     2.213837310030     5.157674255319
 C            0.390190471125     0.870497310030     5.818444255319
 C            1.652220471125     1.360577310030     6.028214255319
 H            2.031740471125     1.339627310030     6.898754255319
 C            2.690680471125     2.359897310030     2.543434255319
 H            2.139810471125     2.863297310030     1.906264255319
 H            3.421850471125     2.928597310030     2.860714255319
 H            3.062830471125     1.569637310030     2.097684255319
 C           -0.721519528875    -3.841122689970     1.232384255319
 H            0.255350471125    -3.826412689970     1.300564255319
 C            3.097220471125    -4.526662689970     1.242874255319
 H            2.505740471125    -4.400212689970     2.013774255319
 H            3.999100471125    -4.748712689970     1.554904255319
 H            3.127890471125    -3.700862689970     0.715834255319
 C            2.575170471125    -5.642992689970     0.388074255319
 C            2.473290471125    -6.950632689970     0.891514255319
 H            2.712740471125    -7.129732689970     1.793514255319
 C            2.033420471125    -7.967242689970     0.089154255319
 H            1.893110471125    -8.838802689970     0.440514255319
 symmetry c1
""")

mol_003 = psi4.core.Molecule.create_molecule_from_string("""
3 10
 Fe           2.345654772036    -2.841197750760    -1.591338297872
 Fe          -2.347775227964     2.851032249240     1.580111702128
 Br           1.481284772036     0.229622249240     2.944141702128
 Br          -1.493835227964    -0.287327750760    -2.976298297872
 O            0.856694772036    -1.705367750760    -1.910088297872
 O           -0.882995227964     1.631172249240     1.914001702128
 N            2.072794772036    -1.799207750760     0.244581702128
 N            4.180644772036    -1.696887750760    -2.172748297872
 N           -2.100305227964     1.759632249240    -0.262928297872
 N            1.304854772036    -4.691777750760    -0.944048297872
 C           -0.647595227964    -0.032547750760    -1.353618297872
 N            3.902154772036    -4.211967750760    -1.135478297872
 N            2.673444772036    -3.607737750760    -3.672998297872
 N           -2.648305227964     3.578302249240     3.699171702128
 N           -1.275845227964     4.646392249240     0.872281702128
 C            1.110034772036    -0.888217750760     0.249031702128
 C            3.845444772036    -4.318867750760    -3.668548297872
 N           -3.880505227964     4.290432249240     1.215071702128
 N           -4.236175227964     1.807692249240     2.181111702128
 C            2.367854772036    -2.993957750760    -4.906148297872
 C           -2.463905227964     2.858492249240    -2.417598297872
 C            3.561214772036    -5.020137750760    -0.062598297872
 H            3.708304772036    -4.521277750760     0.783241702128
 H            4.153124772036    -5.813967750760    -0.053688297872
 C            0.400164772036    -0.887227750760    -1.041988297872
 C           -4.134585227964     1.319422249240    -1.598468297872
 C            5.299104772036    -2.368227750760    -1.878928297872
 C            4.125224772036    -1.486437750760     1.611281702128
 C           -2.915735227964     1.942992249240    -1.469358297872
 C            4.054304772036    -5.092447750760    -2.381978297872
 H            4.959604772036    -5.492977750760    -2.386428297872
 H            3.394844772036    -5.830977750760    -2.337458297872
 C            2.817734772036    -2.087707750760     1.513341702128
 C           -1.190685227964     0.825562249240    -0.236218297872
 C            4.671474772036    -4.468057750760    -4.692458297872
 H            5.439894772036    -5.022397750760    -4.630138297872
 C           -4.893095227964     1.619162249240    -2.729218297872
 H           -5.702965227964     1.143872249240    -2.871678297872
 C            0.047374772036    -5.067267750760    -1.135478297872
 C           -5.352825227964     2.524432249240     1.936261702128
 C            0.665044772036    -0.001277750760     1.290751702128
 C           -1.044345227964     3.460732249240    -2.422048297872
 H           -0.789315227964     3.708222249240    -1.509428297872
 H           -1.030055227964     4.257072249240    -2.991878297872
 H           -0.410605227964     2.797822249240    -2.773738297872
 C            3.150474772036    -3.122937750760    -5.938958297872
 H            2.881144772036    -2.754947750760    -6.775898297872
 C            4.254334772036    -0.609257750760    -2.942908297872
 C            4.865054772036    -1.942107750760     2.719771702128
 H            5.755284772036    -1.636367750760     2.839971702128
 C           -3.469185227964     5.119592249240     0.070961702128
 H           -4.033885227964     5.931152249240     0.044251702128
 H           -3.626585227964     4.611872249240    -0.765978297872
 C            2.092194772036    -5.487737750760    -0.120468297872
 C           -0.412235227964     0.823092249240     0.992481702128
 C            6.581654772036    -1.954407750760    -2.364178297872
 H            7.375274772036    -2.418297750760    -2.123778297872
 C            1.031274772036    -2.346027750760    -5.039698297872
 H            0.420024772036    -2.950427750760    -5.507138297872
 H            1.121094772036    -1.511897750760    -5.547208297872
 H            0.675374772036    -2.146597750760    -4.144888297872
 C           -3.257535227964     3.159682249240    -3.534998297872
 H           -2.961655227964     3.753832249240    -4.211668297872
 C            0.570174772036     6.139322249240     0.449361702128
 H            1.477704772036     6.384232249240     0.587361702128
 C           -0.473145227964    -6.156027750760    -0.507778297872
 H           -1.390375227964    -6.359887750760    -0.636878297872
 C            4.367704772036    -3.784517750760    -5.854378297872
 H            4.979714772036    -3.770157750760    -6.584478297872
 C           -4.540205227964     2.520902249240    -3.588418297872
 H           -5.148495227964     2.764222249240    -4.278448297872
 C           -5.188095227964     3.617712249240     0.974671702128
 H           -5.926015227964     4.270132249240     1.077061702128
 H           -5.218025227964     3.261102249240     0.053151702128
 C            2.985404772036     0.169732249240    -3.241178297872
 H            2.393674772036    -0.371217750760    -3.806558297872
 H            3.213664772036     0.999142249240    -3.708618297872
 H            2.529264772036     0.381502249240    -2.399788297872
 C            2.277864772036    -2.982647750760     2.372531702128
 C           -3.751185227964     4.388262249240     3.748141702128
 C           -2.015325227964     5.529442249240     0.133281702128
 C            4.573964772036    -0.369557750760     0.783241702128
 H            4.103084772036    -0.388907750760    -0.075948297872
 H            5.539904772036    -0.444737750760     0.627431702128
 H            4.383294772036     0.477392249240     1.241781702128
 C           -3.929605227964     5.198322249240     2.421501702128
 H           -4.799865227964     5.670632249240     2.439311702128
 H           -3.212725227964     5.877232249240     2.350271702128
 C            5.188664772036    -3.498647750760    -0.952958297872
 H            5.253174772036    -3.167817750760    -0.018078297872
 H            5.938954772036    -4.126147750760    -1.104318297872
 C            0.254214772036    -6.951597750760     0.284641702128
 H           -0.113075227964    -7.723297750760     0.698661702128
 C            0.949924772036     4.094482249240     1.798251702128
 H            0.437564772036     3.753042249240     2.559511702128
 H            1.733984772036     4.584332249240     2.123231702128
 H            1.242464772036     3.343782249240     1.237331702128
 C           -4.404795227964     0.701552249240     3.031401702128
 C            4.354714772036    -2.782387750760     3.587871702128
 H            4.887744772036    -3.019677750760     4.340231702128
 C            1.598544772036    -6.576527750760     0.458261702128
 H            2.164374772036    -7.111367750760     1.005831702128
 C            0.090534772036     5.011112249240     0.992481702128
 C            3.044164772036    -3.359937750760     3.485481702128
 H            2.712574772036    -3.968337750760     4.135451702128
 C           -0.765555227964    -4.174667750760    -2.092618297872
 H           -1.100775227964    -3.392877750760    -1.607368297872
 H           -1.523595227964    -4.688047750760    -2.453208297872
 H           -0.192435227964    -3.881467750760    -2.831618297872
 C           -2.257815227964     3.073602249240     4.892251702128
 C            6.609034772036    -0.894857750760    -3.169948297872
 H            7.438584772036    -0.613167750760    -3.534998297872
 C            5.464824772036    -0.192177750760    -3.481568297872
 H            5.503704772036     0.564352249240    -4.055858297872
 C            0.855294772036    -3.421207750760     2.247881702128
 H            0.266044772036    -2.644217750760     2.341371702128
 H            0.650134772036    -4.070197750760     2.955721702128
 H            0.717324772036    -3.837997750760     1.370881702128
 C           -1.012805227964     2.263702249240     4.941221702128
 H           -1.053195227964     1.561182249240     4.260091702128
 H           -0.922605227964     1.854912249240     5.827131702128
 H           -0.240185227964     2.841492249240     4.767601702128
 C           -1.476025227964     6.673712249240    -0.449908297872
 H           -2.030445227964     7.249002249240    -0.966308297872
 C           -4.552685227964     0.231472249240    -0.699198297872
 H           -4.390715227964    -0.630717750760    -1.131028297872
 H           -5.508085227964     0.323592249240    -0.498868297872
 H           -4.039425227964     0.281942249240     0.133281702128
 C           -3.070975227964     3.249472249240     6.036361702128
 H           -2.838665227964     2.816292249240     6.851041702128
 C           -6.590575227964     2.200012249240     2.555051702128
 H           -7.350225227964     2.749972249240     2.403691702128
 C           -4.446835227964     4.625322249240     4.794311702128
 H           -5.181085227964     5.227952249240     4.758691702128
 C           -3.125295227964    -0.148047750760     3.222821702128
 H           -2.731055227964    -0.345807750760     2.350271702128
 H           -3.355335227964    -0.985717750760     3.676911702128
 H           -2.480515227964     0.350402249240     3.765951702128
 C           -6.703955227964     1.100042249240     3.378641702128
 H           -7.541625227964     0.876732249240     3.765951702128
 C           -0.255195227964     6.947302249240    -0.298538297872
 H            0.102194772036     7.724772249240    -0.708108297872
 C           -4.110205227964     3.983472249240     5.991841702128
 H           -4.654745227964     4.093712249240     6.762001702128
 C           -5.611675227964     0.332362249240     3.627941702128
 H           -5.667145227964    -0.432427750760     4.188861702128
 symmetry c1
""")

opts = {'scf_type': 'DIRECT', 'basis': 'STO-3G', 'reference': 'rohf', 'memory': '4 Gb', 'df_scf_guess': False}

psi4.set_options(opts)

e_rohf, wfn_rohf = energy('scf', molecule=mol_002, return_wfn=True)

